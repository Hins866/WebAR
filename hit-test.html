<!doctype html>
<html>
    <head>
      <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
      <script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>
      <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
      <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
      <link href="//fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <script src="js/ar-shadow-helper.js"></script>
      <script src="js/ar-cursor.js"></script>
      <script src="js/hit-test.js"></script>
      <link rel="stylesheet" href="style.css">

      <style>
        body {
          font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }
        
        #dom-overlay-message {
          position: absolute;
          left: 0;
          bottom: 0;
          right: 0;
          padding: 1em;
          background: #33333355;
          border-top: 5px solid #ffffff55;
          color: white;
        }

        .a-dom-overlay button {
          padding: 1em;
          appearance: none;
          background: #00000055;
          border: 3px solid white;
          border-radius: 1em;
          margin: 1em 1em 0 0;
          color: white;
        }
      </style>  
    </head>

    <body>
      <a-scene
        webxr="overlayElement:#dom-overlay;"
        background="color:skyblue;"
        reflection="directionalLight:#dirlight;"
        ar-hit-test="target:#place-model;type:footprint;footprintDepth:0.2;"
        shadow="type: pcfsoft"
        gltf-model="dracoDecoderPath: https://cdn.jsdelivr.net/npm/three@0.129.0/examples/js/libs/draco/gltf/;"
        ar-cursor raycaster="objects: #place-model *"
        model-change
      >
        <a-assets>
          <a-asset-item id="CP1-model" src="./model/bird/scene.gltf"></a-asset-item>
          <a-asset-item id="CP2-model" src="./model/magnemite/scene.gltf"></a-asset-item>
          <a-asset-item id="CP3-model" src="./model/question_mark_block/scene.gltf"></a-asset-item>
          <a-asset-item id="CP4-model" src="./model/articuno/scene.gltf"></a-asset-item>
        </a-assets>

        <a-camera position="0 0.4 1"></a-camera>

        <a-light id="dirlight" auto-shadow-cam intensity="0.7" light="castShadow:true;type:directional" position="10 10 10"></a-light>
        <a-light hide-on-enter-ar intensity="0.3" light="type:hemisphere;color:yellow;groundColor:blue;" position="10 10 10"></a-light>
        <a-entity hide-on-enter-ar environment="lighting:none;shadow:true;"></a-entity>

        <!-- This plane is only visible in AR and follows the given target to provide it with shadows.-->
        <a-entity
          material="shader:shadow; depthWrite:false; opacity:0.9;"
          visible="false"
          geometry="primitive:shadow-plane;"
          shadow="cast:false;receive:true;"
          ar-shadow-helper="target:#place-model;light:#dirlight;"
        ></a-entity>
        
        <!-- This is hidden when the user first enters ar but becomes visible when the user can place it -->
        <a-entity hide-on-hit-test-start shadow id="place-model" scale="0.2 0.2 0.2" position="0.2 0 -0.4">
          <a-gltf-model position="-1 2.15 1" scale="0.2 0.2 0.2" src="#CP1-model" animation-mixer></a-gltf-model>
        </a-entity>
      </a-scene>

      <div id="dom-overlay">
        <div class="centered instructions">AR Treasure Fragment Collection GAME - Place Mode</div>
        <div class="centered">
          <button onclick="Savedpoint()">Saved</button>
          <button onclick="ClearSavedpoint()">Clear</button>
        </div>
        <div id="dom-overlay-message">Enter AR to start.</div>
      </div>
      
      <div class="glitchButton" style="position: absolute; top: 1em; right: 1em;"></div><script src="https://button.glitch.me/button.js"></script>
      <div class="ui"><img id="snap">
        <a href ="https://hins866.github.io/WebAR" id="Marker-Based" title="Marker Based"><i class=" material-icons">image_search</i></a> 
        <a href ="https://hins866.github.io/WebAR/gps" id="GPS-Mode" title="GPS Mode" ><i class=" material-icons">place</i></a>      
        <a href ="#" id="delete-photo" title="Delete Photo" class="disabled"><i class=" material-icons">delete</i></a>
        <a href ="#" id="take-photo" title="Take Photo"><i class="material-icons">photo_camera</i></a>
        <a href ="#" id="download-photo" download="WebARCap.png" title="Save Photo" class="disabled" target="_blank"> <i class="material-icons">file_download</i></a>
      </div>
    <script src="js/screenshot.js"></script> 
    </body>

</html>
